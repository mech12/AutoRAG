# 대시보드 고도화

## 개요

기존에 분리되어 있던 대시보드들을 통합하여 단일 진입점에서 모든 기능을 사용할 수 있도록 개선.

## 통합 대시보드 (Streamlit 버전) - 권장

### 실행 방법

```bash
make compare-web
# http://localhost:8502 에서 접속
```

### 파일 위치

- `scripts/compare_web.py`

### 기능

| 탭 | 설명 |
|----|------|
| 📊 Compare Dashboard | 두 테스트 케이스의 평가 결과를 나란히 비교 |
| 💬 Compare Web | 두 테스트 케이스에 동일한 질문을 보내고 응답 비교 |

### UI 구조

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  🔄 AutoRAG 통합 비교                                      localhost:8502  │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────┐  ┌─────────────────────┐                           │
│  │ 📊 Compare Dashboard│  │   💬 Compare Web    │                           │
│  └─────────────────────┘  └─────────────────────┘                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  [Tab 1: Compare Dashboard - 평가 결과 비교]                                │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ 📖 용어 설명 (클릭하여 펼치기)                                        │    │
│  │  [재현율] [정밀도] [F1] [ROUGE] [실행시간] [Top-K] ...               │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌────────────────────────────┐  ┌────────────────────────────┐             │
│  │  테스트케이스 A [Select▼] │  │  테스트케이스 B [Select▼] │             │
│  │  ○ Summary ○ Node ○ QA ○ Config │  │  ○ Summary ○ Node ○ QA ○ Config │ │
│  │  (평가 결과 / 차트 표시)  │  │  (평가 결과 / 차트 표시)  │             │
│  └────────────────────────────┘  └────────────────────────────┘             │
│                                                                             │
│  [Tab 2: Compare Web - 질의 비교]                                           │
│  ┌─────────────────────────────────────────────────────────────┐            │
│  │ 🔗 동시 질문: [____________________] [양쪽에 질문 보내기]  │            │
│  └─────────────────────────────────────────────────────────────┘            │
│  ┌────────────────────────────┐  ┌────────────────────────────┐             │
│  │  테스트케이스 A [Select▼] │  │  테스트케이스 B [Select▼] │             │
│  │  ┌──────────────────────┐ │  │  ┌──────────────────────┐ │             │
│  │  │ 🧑 질문: ...         │ │  │  │ 🧑 질문: ...         │ │             │
│  │  │ 🤖 답변: ...         │ │  │  │ 🤖 답변: ...         │ │             │
│  │  └──────────────────────┘ │  │  └──────────────────────┘ │             │
│  │  [질문 입력...] [전송]   │  │  [질문 입력...] [전송]   │             │
│  └────────────────────────────┘  └────────────────────────────┘             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 기술 스택

- **프레임워크**: Streamlit
- **채팅 UI**: Streamlit chat 위젯
- **차트**: Matplotlib/Seaborn
- **RAG 실행**: `autorag.deploy.Runner` 사용

### 주요 특징

1. **단일 진입점**: 하나의 URL에서 평가 결과 비교와 질의 비교 모두 가능
2. **Runner 캐싱**: 테스트 케이스별 Runner를 세션 상태에 캐싱하여 재사용
3. **동시 질문**: 양쪽 테스트 케이스에 동일한 질문을 한 번에 전송
4. **용어 설명**: RAG 메트릭 용어 설명 (클릭하여 상세 내용 확인)
5. **다중 뷰**: Summary, Node별 상세 차트, QA 데이터, Config YAML 확인 가능

### Compare Dashboard 탭 기능

- **Summary**: 전체 Trial 요약 (각 노드의 best module 정보)
- **Node 뷰**: Strip plot, Box plot으로 메트릭 분포 시각화
- **QA 뷰**: 질의-응답 데이터셋 확인
- **Config 뷰**: 실행에 사용된 YAML 설정 확인
- **용어 설명**: 검색 메트릭 (Recall, Precision, F1, ROUGE 등) 설명

## 전체 대시보드/웹 명령어 정리

| 명령어 | 포트 | 프레임워크 | 설명 |
|--------|------|------------|------|
| `make compare-web` | 8502 | Streamlit | **통합 대시보드 (권장)** |
| `make multi-dashboard` | 7690 | Panel | 단일 테스트케이스 대시보드 |
| `make compare-dashboard` | 7691 | Panel | 비교 대시보드 (평가 결과만) |
| `make multi-web` | 8501 | Streamlit | 단일 테스트케이스 채팅 |

## 레거시: Panel 통합 대시보드

> ⚠️ Panel 버전(`unified_dashboard.py`)은 llama_index 의존성 문제로 동작하지 않을 수 있습니다.
> Streamlit 버전(`compare_web.py`)을 사용하세요.

```bash
# Panel 버전 (비권장)
make unified-dashboard  # port 7700
```

## 향후 개선 사항

- [ ] QA 데이터 편집 기능
- [ ] Config 에디터 탭 추가
- [ ] 테스트 케이스 실행 기능 통합
- [ ] 3개 이상 테스트 케이스 동시 비교
